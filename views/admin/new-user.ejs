<%- include('../partials/header', { title: title }) %>

<div class="row">
  <div class="col-md-12 mb-4">
    <div class="card shadow">
      <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
        <h3 class="mb-0">إضافة مستخدم جديد</h3>
        <a href="/admin/users" class="btn btn-light btn-sm">العودة لقائمة المستخدمين</a>
      </div>
      <div class="card-body">
        <% if(typeof error_msg !== 'undefined' && error_msg.length > 0) { %>
          <div class="alert alert-danger">
            <%= error_msg %>
          </div>
        <% } %>
        <% if(typeof success_msg !== 'undefined' && success_msg.length > 0) { %>
          <div class="alert alert-success">
            <%= success_msg %>
          </div>
        <% } %>
        <form action="/admin/users" method="POST" id="addUserForm">

          <div class="mb-3">
            <label for="email" class="form-label">البريد الإلكتروني</label>
            <input type="email" class="form-control" id="email" name="email" required>
          </div>
          <div class="mb-3">
            <label for="password" class="form-label">كلمة المرور</label>
            <input type="password" class="form-control" id="password" name="password" required minlength="6">
            <div class="form-text">يجب أن تكون كلمة المرور على الأقل 6 أحرف</div>
          </div>
          <div class="mb-3">
            <label for="role" class="form-label">الدور</label>
            <select class="form-select" id="role" name="role" required>
              <option value="user">مستخدم عادي</option>
              <option value="manager">مشرف</option>
              <option value="admin">مدير</option>
            </select>
          </div>
          <div class="d-grid gap-2">
            <button type="submit" class="btn btn-primary">إضافة المستخدم</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- إضافة سكريبت لتتبع إرسال النموذج -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('addUserForm');
  if (form) {
    form.addEventListener('submit', function(e) {
      // e.preventDefault(); // تعليق هذا السطر للسماح بإرسال النموذج
      console.log('تم إرسال النموذج');
      console.log('البريد الإلكتروني:', document.getElementById('email').value);
      console.log('كلمة المرور:', document.getElementById('password').value);
      console.log('الدور:', document.getElementById('role').value);
    });
    console.log('تم تسجيل مستمع الحدث للنموذج');
  } else {
    console.error('لم يتم العثور على النموذج');
  }
});
</script>

<%- include('../partials/footer') %>
